/*1297736844,169775814*/

if (window.CavalryLogger) { CavalryLogger.start_js(["EpWki"]); }

function InstrumentedLogger(a){if(this===window)return new InstrumentedLogger(a);if(InstrumentedLogger._instances[a])return InstrumentedLogger._instances[a];copy_properties(this,{id:a,_phases:{}});return InstrumentedLogger._instances[a]=this;}copy_properties(InstrumentedLogger,{_instances:{}});copy_properties(InstrumentedLogger.prototype,{beginPhase:function(a){if(this._phases[a]&&this._phases[a].start)this.endPhase(a);if(typeof(this._phases[a])=='undefined')this._phases[a]={start:0,count:0,duration:0};this._phases[a].start=new Date().getTime();return this;},endPhase:function(a){var b=this._phases[a];if(b&&b.start){b.count++;b.duration+=new Date().getTime()-b.start;b.start=null;}return this;},dumpAndReset:function(){this.dump();return this.reset();},dump:function(){for(var b in this._phases){var c=this._phases[b];var a=(this.id?this.id+'::':'')+b;}return this;},get:function(a){if(this._phases[a])return this._phases[a].duration/this._phases[a].count;return 0;},reset:function(){this._phases={};return this;}});InstrumentedLogger.prototype.b=InstrumentedLogger.prototype.beginPhase;InstrumentedLogger.prototype.e=InstrumentedLogger.prototype.endPhase;InstrumentedLogger.prototype.d=InstrumentedLogger.prototype.dump;InstrumentedLogger.prototype.D=InstrumentedLogger.prototype.dumpAndReset;InstrumentedLogger.prototype.r=InstrumentedLogger.prototype.reset;var IL=InstrumentedLogger;
var Base64=(function(){var c='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';function d(e){e=(e.charCodeAt(0)<<16)|(e.charCodeAt(1)<<8)|e.charCodeAt(2);return String.fromCharCode(c.charCodeAt(e>>>18),c.charCodeAt((e>>>12)&63),c.charCodeAt((e>>>6)&63),c.charCodeAt(e&63));}var a='>___?456789:;<=_______'+'\0\1\2\3\4\5\6\7\b\t\n\13\f\r\16\17\20\21\22\23\24\25\26\27\30\31'+'______\32\33\34\35\36\37 !"#$%&\'()*+,-./0123';function b(e){e=(a.charCodeAt(e.charCodeAt(0)-43)<<18)|(a.charCodeAt(e.charCodeAt(1)-43)<<12)|(a.charCodeAt(e.charCodeAt(2)-43)<<6)|a.charCodeAt(e.charCodeAt(3)-43);return String.fromCharCode(e>>>16,(e>>>8)&255,e&255);}return {encode:function(f){f=unescape(encodeURI(f));var e=(f.length+2)%3;f=(f+'\0\0'.slice(e)).replace(/[\s\S]{3}/g,d);return f.slice(0,f.length+e-2)+'=='.slice(e);},decode:function(g){g=g.replace(/[^A-Za-z0-9+\/]/g,'');var f=(g.length+3)&3,e;g=(g+'AAA'.slice(f)).replace(/..../g,b);g=g.slice(0,g.length+f-3);try{return decodeURIComponent(escape(g));}catch(e){throw new Error('Not valid UTF-8');}},encodeObject:function(e){return Base64.encode(JSON.encode(e));},decodeObject:function(e){return JSON.decode(Base64.decode(e));},encodeNums:function(e){return String.fromCharCode.apply(String,e.map(function(f){return c.charCodeAt((f|-(f>63))&-(f>0)&63);}));}};})();
function ContextualDialog(b){var a=new Dialog();copy_properties(a,ContextualDialog.prototype);a._setFromModel(b);return a;}ContextualDialog.prototype={setContext:function(a){this._context=a;this._dirty();return this;},_buildDialogContent:function(){Bootloader.loadComponents('contextual-dialog-css',function(){CSS.addClass(this._obj,'contextual_dialog');this._content=this._frame=$N('div',{className:'contextual_dialog_content'});this._arrow=$N('div',{className:'arrow'});DOM.setContent(this._popup,[this._content,this._arrow]);}.bind(this));},_resetDialogObj:function(){if(!this._context)return;var a=Vector2.getElementPosition(this._context);var c=this._context.offsetWidth,b=this._context.offsetHeight;var d=a.x,e=a.y+b;if(c<64)d+=c/2-32;new Vector2(d,e,'document').setElementPosition(this._popup);},_renderDialog:function(a){if(window!=top)this._auto_focus=false;Dialog.prototype._renderDialog.call(this,a);}};
function Template(a){copy_properties(this,{_templateSource:a});}copy_properties(Template,{_operatorRepeat:function(d,a){var f='';var c=d.match(/([^:]*):(.*)/);if(!(!c))if(!(!TemplateRegistry.hasTemplate(c[2])))if(a[c[1]]){var e=TemplateRegistry.getTemplate(c[2]);var b=$A(a[c[1]]);f+=b.map(function(h,g){return h.render(g);}.curry(e)).join(' ');}return f;}});copy_properties(Template.prototype,{getSource:function(){return this._templateSource;},render:function(b){var a=function(d,c,f,e){switch(f){case 'H':return d[e]||'';case 'R':return Template._operatorRepeat(e,d);default:if(!d[e])return '';return window.HTML&&HTML.isHTML(d[e])?d[e].getContent():htmlize(d[e]);}return d[e]?translator(d[e]):'';}.curry(b||{});return this._templateSource.replace(/\$(H|R)?{([^\}]*)\}/g,a);}});var TemplateRegistry={_storage:{},registerTemplate:function(a,b){if(typeof(b)=="string")b=new Template(b);this._storage[a]=b;return this;},unregisterTemplate:function(a){delete this._storage[a];},hasTemplate:function(a){return a in this._storage;},getTemplate:function(a){if(this.hasTemplate(a))return this._storage[a];return null;},registerServerSideTemplate:function(d,b,e,c){b=b||bagofholding;e=!!e;c=!!c;if(this.hasTemplate(d)){b();return this;}var a=new AsyncRequest(d).setReadOnly(true).setMethod('GET').setOption('asynchronous',!e).setOption('suppressEvaluation',!c);if(!e)a.setErrorHandler(this._registerErrorHandler.bind(this,d)).setHandler(this._registerHandler.bind(this,d,c,b));a.send();if(e){var f=this._stripHasteComments(a.transport.responseText);this.registerTemplate(d,new Template(f));b();}return this;},_registerErrorHandler:function(a,b){},_registerHandler:function(c,b,a,e){var d=e.getPayload();var f=null;if(b){if(d.template)f=d.template;}else f=this._stripHasteComments(d.responseText);if(f){this.registerTemplate(c,f);a();}},_stripHasteComments:function(a){return a.replace(/^\s*\/\*\*?(.|\n)*\*\//m,'');},_onRegisterTemplate:function(b,a){if(b=='template/registerTemplate'){if(!(!a||!a.name||!a.template))this.registerTemplate(a.name,a.template);return false;}return true;}};Arbiter.subscribe('template/registerTemplate',TemplateRegistry._onRegisterTemplate.bind(TemplateRegistry),Arbiter.SUBSCRIBE_ALL);
function TemplateObject(c,a){a=a||{};if(!(c instanceof Template))if(TemplateRegistry.hasTemplate(c)){c=TemplateRegistry.getTemplate(c);}else if(c instanceof URI){TemplateRegistry.registerServerSideTemplate(c.toString(),null,true);c=TemplateRegistry.getTemplate(c);}if(c==null)throw new Error("Template could not be found");var b=c.render(a);copy_properties(this,{_nodes:HTML(b).getNodes(),_template:c,_rendered:b});TemplateObject.bindNodes(this._nodes,this);}copy_properties(TemplateObject,{bindNodes:function(f,g){var a=[];for(var c=0;c<f.length;c++)if(f[c].nodeType==DOM.NODE_TYPES.ELEMENT){a.push(f[c]);var e=f[c].getElementsByTagName('*');a=a.concat($A(e));}for(var c=0;c<a.length;c++){var b=a[c].getAttribute('bindPoint');var d=a[c].getAttribute('listen');if(b)if(hasArrayNature(g[b])){g[b].push(a[c]);}else g[b]=a[c];if(d)d.replace(/(\w+) *: *(\w+)/g,function(k,j,h,i){if(typeof(this[i])=="function"){Event.listen(k,h,bind(this,this[i]));}else Event.listen(k,h,bind(this,TemplateObject._eventWrapper,i));}.bind(g,a[c]));}},_eventWrapper:function(a,event){if(typeof(this[a])=="function"){return this[a](event);}else return true;}});copy_properties(TemplateObject.prototype,{getNodes:function(){return this._nodes;},getRendered:function(){return this._rendered;}});
function UrlDetector(a){this.element=a;this.lastCharCount=0;this.lastScrapedURL=null;this.detectionInterval=null;this.suppressDetection=bagofholding;Event.listen(a,'focus',this.startDetectionInterval.bind(this));Event.listen(a,'blur',this.stopDetectionInterval.bind(this));var b=DOM.isNode(this.element,['input','textarea']);copy_properties(this,{getText:b?function(){return this.element.value;}:function(){return DOM.getText(this.element);},setText:b?function(c){this.element.value=c;}:function(c){DOM.setContent(this.element,c);}});}UrlDetector.mixin('Arbiter',{getText:bagofholding,setText:bagofholding,setSuppressDetectionCheck:function(a){this.suppressDetection=a;},startDetectionInterval:function(){if(this.detectionInterval||this.suppressDetection())return;this.detectionInterval=setInterval(this.detectionIntervalFire.bind(this),250);},stopDetectionInterval:function(){this.detectionInterval=clearInterval(this.detectionInterval);},detectionIntervalFire:function(){if(this.suppressDetection())return;var a=this.getText().length;if((a-this.lastCharCount)>5||(this.lastCharCount==0&&a>1))var b=true;this.lastCharCount=a;var c=this.detectUrl(b);if(c)this.inform('urlDetected',c);},detectUrl:function(d){var g='',f=this.getText(),e=-1,a=-1;if(d){g=f.match(/(?:^|[^a-z])(www\.\S+)/mi);if(g){e=f.indexOf(g[1]);a=e+g[1].length;g="http://"+g[1];}else{var c=f.match(/(http|fb):\/\/\S*/i);if(c){g=c[0];e=f.indexOf(c[0]);a=e+c[0].length;}}}else{g=f.match(/(?:^|[^a-z])(www\.\S+[\s|\)|\!])/mi);if(g){e=f.indexOf(g[1]);a=e+g[1].length;g="http://"+g[1];}else{var c=f.match(/(http|fb):\/\/\S*[\s|\)|\!]/i);if(c){g=c[0];e=f.indexOf(c[0]);a=e+c[0].length;}}}if(g){g=g.replace(/[\s|\)]/g,'');while(true){var b=g.charAt(g.length-1);if(!b.match(/[,|.|\!]/))break;g=g.substr(0,g.length-1);}if(g!=this.lastScrapedURL){this.lastScrapedURL=g;if(g.search('fb:')==0)this.setText(f.substr(0,e)+f.substr(a));}else g='';}return g;}});
var PrivacyBaseValue={FACEBOOK_EMPLOYEES:112,CUSTOM:111,OPEN:100,EVERYONE:80,NETWORKS_FRIENDS_OF_FRIENDS:60,NETWORKS_FRIENDS:55,FRIENDS_OF_FRIENDS:50,ALL_FRIENDS:40,SELF:10,NOBODY:0};var PrivacyFriendsValue={EVERYONE:80,NETWORKS_FRIENDS:55,FRIENDS_OF_FRIENDS:50,ALL_FRIENDS:40,SOME_FRIENDS:30,SELF:10,NO_FRIENDS:0};var PrivacySpecialPreset={ONLY_CORP_NETWORK:200,COLLEGE_NETWORK_FRIENDS_OF_FRIENDS:201,COLLEGE_NETWORK_FRIENDS:202};var PrivacyNetworkTypes={TYPE_COLLEGE:1,TYPE_HS:2,TYPE_CORP:3,TYPE_GEO:4,TYPE_MANAGED:14,TYPE_TEST:50};var PrivacyNetworksAll=1;copy_properties(PrivacyBaseValue,PrivacySpecialPreset);function PrivacyModel(){this.value=PrivacyBaseValue.ALL_FRIENDS;this.friends=PrivacyFriendsValue.NO_FRIENDS;this.networks=[];this.objects=[];this.lists=[];this.lists_x=[];this.list_anon=0;this.ids_anon=[];this.list_x_anon=0;this.ids_x_anon=[];this.tdata={};return this;}copy_properties(PrivacyModel.prototype,{init:function(k,a,h,i,f,g,d,b,e,c,j){this.value=k;this.friends=a;this.networks=h.clone();this.objects=i.clone();this.lists=f.clone();this.lists_x=g.clone();this.list_anon=d;this.ids_anon=b.clone();this.list_x_anon=e;this.ids_x_anon=c.clone();j=j||{};copy_properties(this.tdata,j);},clone:function(){var a=new PrivacyModel();a.init(this.value,this.friends,this.networks,this.objects,this.lists,this.lists_x,this.list_anon,this.ids_anon,this.list_x_anon,this.ids_x_anon,this.tdata);return a;},getData:function(){var b=['value','friends','networks','objects','lists','lists_x','list_anon','ids_anon','list_x_anon','ids_x_anon'];var d={};for(var c=0;c<b.length;++c){var a=b[c];d[a]=this[a];}return d;}});
function BasePrivacyWidget(){}BasePrivacyWidget.mixin('Arbiter',{init:function(a,c,b){this._controllerId=a;this._root=$(a);this._options=copy_properties(b||{},c||{});this._formDataKey='privacy_data';},getData:function(){return this._model.getData();},_getPrivacyData:function(a){a=a||this._fbid;var b={};b[a]=this.getData();return b;},getRoot:function(){return this._root;},_initSelector:function(a){this._selector=a;Selector.listen(a,'select',function(b){var c=Selector.getOptionValue(b.option);this._onMenuSelect(c);}.bind(this));Event.listen(a,'click',function(){this.inform('menuActivated');}.bind(this));},_isCustomSetting:function(a){return (a==PrivacyBaseValue.CUSTOM);},_updateSelector:function(a){var b=this._model.objects;if(b&&b.length){selected_value=b[0];}else selected_value=this._model.value;Selector.setSelected(this._selector,selected_value);if(!this._isCustomSetting(selected_value))return;var c=Selector.getOption(this._selector,PrivacyBaseValue.CUSTOM+'');c.setAttribute('data-label',a||_tx("Personalizar"));Selector.updateSelector(this._selector);},_onPrivacyChanged:function(){this._saveFormData();this.inform('privacyChanged',this.getData());Arbiter.inform(UIPrivacyWidget.GLOBAL_PRIVACY_CHANGED_EVENT,{fbid:this._fbid,data:this.getData()});},_saveFormData:function(){var b=DOM.find(this._root,'div.UIPrivacyWidget_Form');DOM.empty(b);var a={};if(this._options.useLegacyFormData){a[this._formDataKey]=this.getData();}else a[this._formDataKey]=this._getPrivacyData();Form.createHiddenInputs(a,b);}});
function UIPrivacyWidget(){this.parent.construct(this);}copy_properties(UIPrivacyWidget,{GLOBAL_PRIVACY_CHANGED_EVENT:'UIPrivacyWidget/globalPrivacyChanged',instances:{},getInstance:function(a){return this.instances[a];}});UIPrivacyWidget.extend('BasePrivacyWidget');UIPrivacyWidget.mixin('Arbiter',{init:function(i,a,b,h,c,e,g){var f={autoSave:false,saveAsDefaultFbid:0,initialExplanation:'',useLegacyFormData:false,composerEvents:false};if(b=='0')b=0;this.parent.init(a,g,f);this._lists=c;this._networks=e;this._fbid=b;this._row=h;this._groups={};for(var d in e)this._groups[e[d].fbid]=d;UIPrivacyWidget.instances[this._controllerId]=this;this._initSelector(i);this.setData(this._row,this._options.initialExplanation,true);this._saveFormData();if(this._options.composerEvents)Arbiter.subscribe('composer/publish',this.reset.bind(this));},reset:function(){this._model=this._originalModel.clone();this._modelClone=this._originalModel.clone();this._updateSelector(this._options.initialExplanation);this._saveFormData();return this;},revert:function(){this._model=this._modelClone.clone();this._updateSelector(this._previousDescription);this._saveFormData();return this;},getValue:function(){return this._model.value;},getDefaultValue:function(){return this._originalModel.value;},isEveryonePrivacy:function(){return this._model.value==PrivacyBaseValue.EVERYONE;},dialogOpen:function(){return this._dialog&&this._dialog.getRoot();},setData:function(b,a,c){this._model=new PrivacyModel();this._model.init(b.value,b.friends,b.networks,b.objects,b.lists,b.lists_x,b.list_anon,b.ids_anon,b.list_x_anon,b.ids_x_anon,b.tdata);this._modelClone=this._model.clone();if(c)this._originalModel=this._model.clone();this._previousDescription=a;this._customModel=null;this._updateSelector(a);},setLists:function(a){this._lists=a;return this;},setNetworks:function(a){this._networks=a;return this;},_isCustomSetting:function(a){return (a==PrivacyBaseValue.CUSTOM||a==PrivacyBaseValue.NETWORKS_FRIENDS_OF_FRIENDS||a==PrivacyBaseValue.SELF);},_onMenuSelect:function(b){this._modelClone=this._model.clone();var a=this._isCustomSetting(this._model.value);var c=this._isCustomSetting(b);if(a&&!c)this._customModel=this._model.clone();if(!(a&&c)){this._model.value=b;this._resetModelAuxiliaryData();}if(b==PrivacyBaseValue.CUSTOM){if(this._customModel){this._model=this._customModel.clone();}else if(this._modelClone.value!=PrivacyBaseValue.CUSTOM)this._model.friends=PrivacyFriendsValue.ALL_FRIENDS;this._showDialog();}else{if(this._groups[b]){this._model=new PrivacyModel();this._model.value=PrivacyBaseValue.CUSTOM;this._model.objects=[b];}this._onPrivacyChanged();if(this._options.autoSave)this._saveSetting();}this._updateSelector();},_showDialog:function(){if(!this._fbid){this._model.list_x_anon=0;this._model.list_anon=0;}var a={controller_id:this._controllerId,privacy_data:this.getData(),fbid:this._fbid,save_as_default_fbid:this._options.saveAsDefaultFbid};this._dialog=new Dialog().setAsync(new AsyncRequest('/ajax/privacy/privacy_widget_dialog.php').setData(a)).setModal(true).show();return false;},_resetModelAuxiliaryData:function(){if(this._model.value!=PrivacyBaseValue.CUSTOM){this._model.lists_x=this._model.lists=this._model.networks=this._model.ids_anon=this._model.ids_x_anon=[];this._model.list_x_anon=0;this._model.list_anon=0;}},_saveSetting:function(a){a=a||this._fbid;new AsyncRequest('/ajax/privacy/widget_save.php').setData({privacy_data:this._getPrivacyData(a),fbid:a}).setHandler(this._handleResponse.bind(this)).setErrorHandler(this._handleError.bind(this)).send();},_handleResponse:function(b){var a=b.getPayload();this.setData(a.privacy_row,a.explanation);},_handleError:function(a){AsyncResponse.defaultErrorHandler(a);this.revert();}});
Arbiter.inform("template\/registerTemplate",{name:"\/templates\/UIPager.tmpl",template:"\n\u003cspan class=\"UIPager\" bindPoint =\"root\">\n  \u003cspan class=\"UIPager_PageNum\" bindPoint=\"pageNumber\">\u003c\/span>\n  \u003cspan class=\"UIPager_ButtonWrapper\" bindPoint=\"backWrapper\">\n    \u003ca class=\"UIPager_Button UIPager_ButtonBack\" bindPoint=\"backRoot\" href=\"#\">\u003c\/a>\n  \u003c\/span>\n  \u003cspan class=\"UIPager_ButtonWrapper\" bindPoint=\"forwardWrapper\">\n    \u003ca class=\"UIPager_Button UIPager_ButtonForward\" bindPoint=\"forwardRoot\" href=\"#\">\u003c\/a>\n  \u003c\/span>\n\u003c\/span>\n"},Arbiter.BEHAVIOR_PERSISTENT);
function UIPager(d,b,c,a){copy_properties(this,{_rm:new RenderManager(this),_callback:a||bagofholding,_backHandler:null,_forwardHandler:null,_maxPerPage:b,_total:d,_offset:c,_isDisabled:false,root:null,backRoot:null,forwardRoot:null,pageNumber:null,backWrapper:null,fowardWrapper:null});this.parent.construct(this,URI('/templates/UIPager.tmpl'));this._summaryTextHandler=this._getSummaryText;this._rm.dirty();this._setupHandlers();return this;}UIPager.extend('TemplateObject');UIPager.prototype._setupHandlers=function(){this._backHandler=Event.listen(this.backRoot,'click',this._handleClick.bind(this,'back'));this._forwardHandler=Event.listen(this.forwardRoot,'click',this._handleClick.bind(this,'forward'));};UIPager.prototype._handleClick=function(b){var c;var a;if(b=='forward'){c=this.forwardWrapper;a=1;}else{c=this.backWrapper;a=-1;}if(!CSS.hasClass(c,'UIPager_ButtonDisabled')){this._offset=this._offset+(a*this._maxPerPage);this._callback(this._offset,a);this._rm.dirty();}return false;};UIPager.prototype._getSummaryText=function(a,e,b){if(e==0)return '';if(e<=b){if(e==1){return _tx("1 resultado");}else return _tx("{number_of_results} resultados",{number_of_results:e});}else{if(a+b<e){var c=((a/b+1)*b);}else var c=e;if(e>500){var d=_tx("{starting_offset}-{ending_offset} de m\u00e1s de {number_of_results} resultados",{starting_offset:(a+1),ending_offset:c,number_of_results:500});}else var d=_tx("{starting_offset}-{ending_offset} de {number_of_results} resultados",{starting_offset:(a+1),ending_offset:c,number_of_results:e});return d;}};UIPager.prototype.setCallback=function(a){this._callback=a;return this;};UIPager.prototype.setMaxPerPage=function(a){this._maxPerPage=Math.max(a,0);this._rm.dirty();return this;};UIPager.prototype.setTotal=function(a){this._total=Math.max(a,0);this._rm.dirty();return this;};UIPager.prototype.setOffset=function(a){this._offset=Math.max(a,0);this._rm.dirty();return this;};UIPager.prototype.setPage=function(a){this._offset=Math.max(a-1,0)*this._maxPerPage;this._rm.dirty();return this;};UIPager.prototype.setDisabled=function(a){this._isDisabled=a;this._rm.dirty();return this;};UIPager.prototype.setVertical=function(a){CSS.conditionClass(this.root,'UIPager_Vertical',a);this._rm.dirty();return this;};UIPager.prototype._getCurrentPage=function(){return this._offset/this._maxPerPage+1;};UIPager.prototype._getPageCount=function(){return Math.ceil(this._total/this._maxPerPage);};UIPager.prototype.setSummaryTextHandler=function(a){this._summaryTextHandler=a;this._rm.dirty();return this;};UIPager.prototype._setDisabled=function(a,c){var b;if(a=="back"){b=this.backWrapper;}else if(a=="forward")b=this.forwardWrapper;CSS.conditionClass(b,'UIPager_ButtonDisabled',c);return this;};UIPager.prototype.paint=function(){if(this._offset==0||this._isDisabled){this._setDisabled("back",true);}else this._setDisabled("back",false);if((this._offset+this._maxPerPage)>=this._total||this._isDisabled){this._setDisabled("forward",true);}else this._setDisabled("forward",false);var a=this._summaryTextHandler(this._offset,this._total,this._maxPerPage);if(a){DOM.setContent(this.pageNumber,a);}else hide(this.pageNumber);};UIPager.prototype.resetPager=function(d,b,c,a){this.setOffset(c);this.setTotal(d);this.setMaxPerPage(b);if(a)this._callback=a;this._rm.dirty();};UIPager.prototype.getRoot=function(){return this.root;};UIPager.prototype.setHidden=function(a){CSS.conditionClass(this.root,'hidden_elem',a);return this;};UIPager.prototype.getHidden=function(){return CSS.hasClass(this.root,'hidden_elem');};
function UIErrorForm(c,a,d,b,e){this.container=a;if(!is_empty(d)){this.form=$(d);Event.listen(this.form,'submit',coalesce(e,this.onSubmit).bind(this));}this.errorMap=c;this.displayedErrors={};this.endpoint=b;}UIErrorForm.prototype={attachError:function(b,c){if(!(b in this.errorMap)){var d=DOM.find(this.container,'div[id="UIErrorForm_GenericError"]');var j=$N('h2',{className:'"main_message'},HTML(c));var e=DOM.scry(this.container,'div[id="error_div"]')[0];if(e){DOM.appendContent(e,j);}else{e=$N('div',{id:'error_div',className:"UIMessageBox UIMessageBoxError"},j);DOM.setContent(d,j);show(d);}return;}var f=DOM.find(this.container,'div[id="'+this.errorMap[b]+'_div"]');var h=DOM.find(this.container,'span[id="'+this.errorMap[b]+'_span"]');var g=DOM.find(this.container,'[id="'+this.errorMap[b]+'"]');this.displayedErrors[b]=true;var e=$N('strong',{className:'UIErrorForm_Flag_Inner'},c);var i=$N('strong',{className:'UIErrorForm_Flag',id:b},e);var a=intl_locale_is_rtl()?'right':'left';CSS.setStyle(i,a,'105%');DOM.insertAfter(g,i);CSS.addClass(h,'UIErrorForm_ErrorField');},toggleError:function(a,d){if(this.displayedErrors[a]==d)return;var b=DOM.find(this.container,'strong[id="'+a+'"]');var c=DOM.find(this.container,'span[id="'+this.errorMap[a]+'_span"]');if(d){CSS.addClass(c,'UIErrorForm_ErrorField');CSS.show(b);}else{CSS.removeClass(c,'UIErrorForm_ErrorField');CSS.hide(b);}this.displayedErrors[a]=d;},clearErrors:function(){for(var a in this.displayedErrors)this.toggleError(a,false);var b=DOM.scry(this.container,'div[id="error_box_div"]')[0];if(b)DOM.empty(b);},enableButton:function(a){button=$(a);if(button){Button.setEnabled(button,true);button.disabled=false;}},displayErrors:function(b){this.clearErrors();if(!b)return;for(var a in b)if(a in this.displayedErrors){this.toggleError(a,true);}else this.attachError(a,b[a]);},errorHandler:function(b){var a=b.getPayload();this.displayErrors(a.error_codes);if(a.button_to_enable_on_error)this.enableButton(a.button_to_enable_on_error);},onSubmit:function(){var a=Form.serialize(this.form);var b=new AsyncRequest().setURI(this.endpoint).setData(a).setHandler(this.clearErrors.bind(this)).setErrorHandler(this.errorHandler.bind(this));this.clearErrors();b.send();return false;}};
function CreditsBalanceUpdater(){}CreditsBalanceUpdater.UPDATE='creditsBalance/update';CreditsBalanceUpdater.negBalance='negativeBalance';CreditsBalanceUpdater.repay='needsRepayment';CreditsBalanceUpdater.prototype={init:function(b,a){this.root=b;this.targetBalance=DOM.find(this.root,'span.creditsBalance');Arbiter.inform(CreditsBalanceUpdater.UPDATE,a,Arbiter.BEHAVIOR_STATE);Arbiter.subscribe(CreditsBalanceUpdater.UPDATE,this.oninform.bind(this),Arbiter.SUBSCRIBE_NEW);new LiveMessageReceiver('update_canvas_balance').setHandler(this.oninform_livemessage.bind(this)).register();},oninform_livemessage:function(a){this.oninform(CreditsBalanceUpdater.UPDATE,a);},oninform:function(c,b){if(c==CreditsBalanceUpdater.UPDATE){var a=ge('get_more_link');if(b>=0){CSS.removeClass(this.root,CreditsBalanceUpdater.negBalance);a&&CSS.removeClass(a,CreditsBalanceUpdater.repay);}else{CSS.addClass(this.root,CreditsBalanceUpdater.negBalance);a&&CSS.addClass(a,CreditsBalanceUpdater.repay);}DOM.setContent(this.targetBalance,b);}}};

if (window.Bootloader) { Bootloader.done(["EpWki"]); }